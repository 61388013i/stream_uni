<!DOCTYPE html>
<html lang="zh-Hant">
<head>
Â  <meta charset="UTF-8" />
Â  <title>æ˜Ÿåº§å åœå°å®‡å®™ï½œä»Šæ—¥é‹å‹¢ãƒ»æé†’å¡èˆ‡ä¸‰å¼µç‰Œ</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />

Â  Â  <meta name="description" content="ç·šä¸Šæ˜Ÿåº§å åœå°å·¥å…·ï¼šè¼¸å…¥æ˜Ÿåº§èˆ‡æƒ³å•çš„ç…©æƒ±ï¼ŒAI è‡ªå‹•åˆ¤æ–·ä¸»é¡Œï¼Œç”Ÿæˆä»Šæ—¥é‹å‹¢ã€å»ºè­°èˆ‡å¹¸é‹å…ƒç´ ã€‚">
Â  <meta name="keywords" content="æ˜Ÿåº§å åœ, ä»Šæ—¥é‹å‹¢, æŠ½ç‰Œ, æˆ€æ„›å åœ, å·¥ä½œå åœ, å­¸æ¥­å åœ, å¿ƒæƒ…å åœ, Gemini API">

Â  Â  <meta property="og:title" content="æ˜Ÿåº§å åœå°å®‡å®™ï½œä»Šæ—¥é‹å‹¢ãƒ»æé†’å¡èˆ‡ä¸‰å¼µç‰Œ">
Â  <meta property="og:description" content="è¼¸å…¥æ˜Ÿåº§èˆ‡ç…©æƒ±ï¼Œå°å®‡å®™å¹«ä½ åˆ¤æ–·ä¸»é¡Œï¼ŒæŠ½å‡ºå°æ‡‰çš„é‹å‹¢èˆ‡æé†’å¡ã€‚">
Â  <meta property="og:type" content="website">

Â  <style>
Â  Â  /* ä¿æŒåŸæœ‰çš„ CSS æ¨£å¼ä¸è®Š */
Â  Â  body {
Â  Â  Â  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans TC", sans-serif;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  Â  background: radial-gradient(circle at top, #1b1b3a 0%, #050510 55%, #000000 100%);
Â  Â  Â  color: #f7f7ff;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  }
Â  Â  .card {
Â  Â  Â  background: rgba(14, 14, 40, 0.92);
Â  Â  Â  border-radius: 24px;
Â  Â  Â  padding: 24px 24px 28px;
Â  Â  Â  max-width: 520px;
Â  Â  Â  width: 92%;
Â  Â  Â  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.55);
Â  Â  Â  backdrop-filter: blur(18px);
Â  Â  Â  border: 1px solid rgba(180, 180, 255, 0.25);
Â  Â  }
Â  Â  h1 {
Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  margin-top: 0;
Â  Â  Â  margin-bottom: 0.25rem;
Â  Â  Â  letter-spacing: 0.08em;
Â  Â  Â  text-transform: uppercase;
Â  Â  }
Â  Â  .subtitle {
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  opacity: 0.8;
Â  Â  Â  margin-bottom: 1.1rem;
Â  Â  }
Â  Â  label {
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  display: block;
Â  Â  Â  margin-bottom: 0.35rem;
Â  Â  }
Â  Â  select, textarea {
Â  Â  Â  width: 100%;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.15);
Â  Â  Â  padding: 8px 10px;
Â  Â  Â  font-size: 0.95rem;
Â  Â  Â  margin-bottom: 0.9rem;
Â  Â  Â  background: rgba(10, 10, 30, 0.85);
Â  Â  Â  color: #f7f7ff;
Â  Â  Â  outline: none;
Â  Â  }
Â  Â  select:focus, textarea:focus {
Â  Â  Â  border-color: #b794ff;
Â  Â  Â  box-shadow: 0 0 0 1px rgba(183, 148, 255, 0.7);
Â  Â  }
Â  Â  textarea {
Â  Â  Â  resize: vertical;
Â  Â  Â  min-height: 60px;
Â  Â  }
Â  Â  .pill-row {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 6px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  margin-bottom: 10px;
Â  Â  }
Â  Â  .pill {
Â  Â  Â  font-size: 0.78rem;
Â  Â  Â  padding: 3px 8px;
Â  Â  Â  border-radius: 999px;
Â  Â  Â  border: 1px solid rgba(255,255,255,0.2);
Â  Â  Â  opacity: 0.8;
Â  Â  }
Â  Â  .button-row {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  Â  margin-top: 0.4rem;
Â  Â  Â  margin-bottom: 0.9rem;
Â  Â  }
Â  Â  button {
Â  Â  Â  border-radius: 999px;
Â  Â  Â  border: none;
Â  Â  Â  padding: 8px 14px;
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  font-weight: 600;
Â  Â  Â  background: linear-gradient(135deg, #b794ff, #7f5dff);
Â  Â  Â  color: #050510;
Â  Â  Â  cursor: pointer;
Â  Â  Â  flex: 1;
Â  Â  Â  min-width: 140px;
Â  Â  }
Â  Â  button:hover {
Â  Â  Â  filter: brightness(1.05);
Â  Â  Â  transform: translateY(-1px);
Â  Â  Â  box-shadow: 0 10px 20px rgba(0,0,0,0.4);
Â  Â  }
Â  Â  button:active {
Â  Â  Â  transform: translateY(0);
Â  Â  Â  box-shadow: none;
Â  Â  }
Â  Â  .result-block {
Â  Â  Â  margin-top: 4px;
Â  Â  Â  margin-bottom: 10px;
Â  Â  }
Â  Â  .result-title {
Â  Â  Â  font-size: 0.95rem;
Â  Â  Â  opacity: 0.9;
Â  Â  Â  margin-bottom: 0.3rem;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 6px;
Â  Â  }
Â  Â  .result-box {
Â  Â  Â  background: radial-gradient(circle at top left, rgba(183,148,255,0.15), rgba(10,10,30,0.9));
Â  Â  Â  border-radius: 16px;
Â  Â  Â  padding: 10px 12px;
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  line-height: 1.5;
Â  Â  Â  border: 1px dashed rgba(215, 196, 255, 0.6);
Â  Â  Â  white-space: pre-line;
Â  Â  Â  max-height: 260px;
Â  Â  Â  overflow-y: auto;
Â  Â  }
Â  Â  .hint {
Â  Â  Â  font-size: 0.78rem;
Â  Â  Â  opacity: 0.7;
Â  Â  Â  margin-top: 6px;
Â  Â  }

Â  Â  /* ä¸»é¡Œå€å¡Š CSS */
Â  Â  .topic-row {
Â  Â  Â  margin-top: -4px;
Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  font-size: 0.8rem;
Â  Â  }
Â  Â  .topic-text {
Â  Â  Â  opacity: 0.9;
Â  Â  Â  margin-bottom: 4px;
Â  Â  Â  display: block;
Â  Â  }
Â  Â  .topic-buttons {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 6px;
Â  Â  }
Â  Â  .topic-btn {
Â  Â  Â  border-radius: 999px;
Â  Â  Â  border: 1px solid rgba(255,255,255,0.25);
Â  Â  Â  background: rgba(20, 20, 50, 0.8);
Â  Â  Â  color: #f7f7ff;
Â  Â  Â  font-size: 0.78rem;
Â  Â  Â  padding: 4px 10px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  flex: 0 0 auto;
Â  Â  Â  min-width: auto;
Â  Â  }
Â  Â  .topic-btn:hover {
Â  Â  Â  filter: brightness(1.05);
Â  Â  }
Â  Â  .topic-btn.topic-active {
Â  Â  Â  background: linear-gradient(135deg, #ff9de1, #b794ff);
Â  Â  Â  color: #1a1030;
Â  Â  Â  border-color: rgba(255,255,255,0.8);
Â  Â  Â  font-weight: 600;
Â  Â  }
    /* Loading æ¨£å¼ */
    .loading-pulse {
      animation: pulse-animation 1.5s infinite;
      color: #b794ff;
      font-weight: 600;
    }
    @keyframes pulse-animation {
        0% { opacity: 0.5; }
        50% { opacity: 1.0; }
        100% { opacity: 0.5; }
    }
Â  </style>
</head>
<body>
Â  <div class="card">
Â  Â  <h1>æ˜Ÿåº§å åœå°å®‡å®™</h1>
Â  Â  <div class="subtitle">ä»Šæ—¥é‹å‹¢ã€æé†’å¡èˆ‡ä¸‰å¼µç‰Œï¼Œä¸€æ¬¡æ”¶é½Š âœ¨ (Powered by Gemini)</div>

Â  Â  <div class="pill-row">
Â  Â  Â  <div class="pill">é›²ç«¯ API é€£ç·š</div>
Â  Â  Â  <div class="pill">éœ€ API Key</div>
Â  Â  Â  <div class="pill">ä¸»é¡Œåµæ¸¬ï¼šæˆ€æ„› / å·¥ä½œ / å­¸æ¥­ / å¿ƒæƒ…</div>
Â  Â  </div>

Â  Â  <label for="sign">ä½ çš„æ˜Ÿåº§</label>
Â  Â  <select id="sign">
Â  Â  Â  <option value="ç‰¡ç¾Šåº§">ç‰¡ç¾Šåº§</option>
Â  Â  Â  <option value="é‡‘ç‰›åº§">é‡‘ç‰›åº§</option>
Â  Â  Â  <option value="é›™å­åº§">é›™å­åº§</option>
Â  Â  Â  <option value="å·¨èŸ¹åº§">å·¨èŸ¹åº§</option>
Â  Â  Â  <option value="ç…å­åº§">ç…å­åº§</option>
Â  Â  Â  <option value="è™•å¥³åº§">è™•å¥³åº§</option>
Â  Â  Â  <option value="å¤©ç§¤åº§">å¤©ç§¤åº§</option>
Â  Â  Â  <option value="å¤©è åº§">å¤©è åº§</option>
Â  Â  Â  <option value="å°„æ‰‹åº§">å°„æ‰‹åº§</option>
Â  Â  Â  <option value="æ‘©ç¾¯åº§">æ‘©ç¾¯åº§</option>
Â  Â  Â  <option value="æ°´ç“¶åº§">æ°´ç“¶åº§</option>
Â  Â  Â  <option value="é›™é­šåº§">é›™é­šåº§</option>
Â  Â  </select>

Â  Â  <label for="note">æƒ³è£œå……çµ¦å®‡å®™çŸ¥é“çš„å°äº‹ï¼ˆAI æœƒåƒè€ƒé€™æ®µå…§å®¹ï¼‰</label>
Â  Â  <textarea id="note" placeholder="ä¾‹å¦‚ï¼šæœ€è¿‘åœ¨ç…©æƒ±å–œæ­¡çš„äººã€å ±å‘Šã€å·¥ä½œæˆ–åªæ˜¯è¦ºå¾—å¿ƒå¾ˆç´¯ã€‚"></textarea>

Â  Â  Â  Â  <div class="topic-row">
Â  Â  Â  <span id="topicText" class="topic-text">
Â  Â  Â  Â  ç›®å‰ä¸»é¡Œï¼šä¸€èˆ¬ï¼ç¶œåˆï¼ˆå¦‚æœåˆ¤æ–·éŒ¯ï¼Œå¯ä»¥é»ä¸‹é¢æŒ‰éˆ•æ‰‹å‹•èª¿æ•´ï¼‰
Â  Â  Â  </span>
Â  Â  Â  <div class="topic-buttons">
Â  Â  Â  Â  <button type="button" class="topic-btn" data-topic="love">æˆ€æ„›ï¼é—œä¿‚</button>
Â  Â  Â  Â  <button type="button" class="topic-btn" data-topic="work">å·¥ä½œï¼è·å ´</button>
Â  Â  Â  Â  <button type="button" class="topic-btn" data-topic="study">å­¸æ¥­ï¼è€ƒè©¦</button>
Â  Â  Â  Â  <button type="button" class="topic-btn" data-topic="heal">å¿ƒæƒ…ï¼ç™‚ç™’</button>
Â  Â  Â  Â  <button type="button" class="topic-btn" data-topic="other">ä¸€èˆ¬ï¼è‡ªç”±ç™¼æ®</button>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="button-row">
Â  Â  Â  Â  Â  Â  <button id="btnHoroscope" onclick="getHoroscope()">ğŸ”® ç²å¾—ä»Šæ—¥è§£æ</button>
Â  Â  </div>

Â  Â  <div class="result-block">
Â  Â  Â  <div class="result-title">ğŸ” è§£æçµæœ</div>
Â  Â  Â  <div id="result" class="result-box">
Â  Â  Â  Â  é¸æ“‡æ˜Ÿåº§ä¸¦è¼¸å…¥ä½ çš„ç…©æƒ±ï¼Œé»æ“Šã€Œç²å¾—ä»Šæ—¥è§£æã€ï¼ŒAI å°‡æ ¹æ“šä½ çš„ä¸»é¡Œç”Ÿæˆé‹å‹¢ã€å»ºè­°èˆ‡å¹¸é‹å…ƒç´ ã€‚
Â  Â  Â  </div>
Â  Â  Â  <div class="hint">â€» å…§å®¹ç”± Gemini AI æ¨¡å‹ç”Ÿæˆï¼Œåƒ…ä¾›åƒè€ƒã€‚è«‹ç¢ºèªå¾Œç«¯ Flask æœå‹™å’Œ Ngrok (æˆ–éƒ¨ç½²æœå‹™) æ­£åœ¨é‹è¡Œã€‚</div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  // ğŸš¨ æ­¥é©Ÿ 1ï¼šè«‹åœ¨é€™è£¡æ‰‹å‹•è²¼ä¸Šæ‚¨æœ€æ–°çš„ Ngrok HTTPS URL ğŸš¨
    // è«‹å°‡ 'YOUR_NGROK_HTTPS_URL_HERE' æ›¿æ›ç‚º Ngrok æä¾›çš„ç¶²å€ã€‚
Â  Â  const API_ENDPOINT = 'https://uninured-buzzingly-verna.ngrok-free.dev/api/get_horoscope';
    
    // --- UI å…ƒç´  ---
Â  Â  const resultBox = document.getElementById("result");
    const signSelect = document.getElementById("sign");
    const noteTextarea = document.getElementById("note");
    const topicTextSpan = document.getElementById("topicText");
    const horoscopeButton = document.getElementById("btnHoroscope");

Â  Â  // --- ä¸»é¡Œè¨­å®š (ç”¨æ–¼æç¤ºè©ä¸­) ---
Â  Â  const topicLabels = {
Â  Â  Â  love: "æˆ€æ„›ï¼é—œä¿‚",
Â  Â  Â  work: "å·¥ä½œï¼è·å ´",
Â  Â  Â  study: "å­¸æ¥­ï¼è€ƒè©¦",
Â  Â  Â  heal: "å¿ƒæƒ…ï¼ç™‚ç™’",
Â  Â  Â  other: "ä¸€èˆ¬ï¼ç¶œåˆ"
Â  Â  };

Â  Â  let currentTopic = "other";
Â  Â  let topicOverride = null; 

Â  Â  // ---- ä¸»é¡Œåµæ¸¬é‚è¼¯ ----
Â  Â  function detectTopicFromNote(note) {
Â  Â  Â  const n = note.trim();
Â  Â  Â  if (!n) return "other";

Â  Â  Â  const loveKeywords = ["å–œæ­¡", "æ›–æ˜§", "æˆ€æ„›", "æ„Ÿæƒ…", "åœ¨ä¸€èµ·", "åˆ†æ‰‹", "å‘Šç™½", "å¿ƒå‹•", "ç”·å‹", "å¥³å‹"];
Â  Â  Â  const workKeywords = ["å·¥ä½œ", "ä¸Šç­", "è·å ´", "å…¬å¸", "è€é—†", "ä¸»ç®¡", "é¢è©¦", "åŠ ç­", "å°ˆæ¡ˆ"];
Â  Â  Â  const studyKeywords = ["å ±å‘Š", "ä½œæ¥­", "åŠŸèª²", "è€ƒè©¦", "å­¸æ ¡", "æœŸä¸­", "æœŸæœ«", "è«–æ–‡", "å­¸ç¿’"];
Â  Â  Â  const healKeywords = ["å¿ƒç´¯", "ç„¦æ…®", "æ†‚é¬±", "æƒ³å“­", "å´©æ½°", "å£“åŠ›", "å¥½ç´¯", "ç–²æ†Š", "ä¸æƒ³å‹•"];

Â  Â  Â  const check = (list) => list.some(k => n.includes(k));

Â  Â  Â  if (check(loveKeywords)) return "love";
Â  Â  Â  if (check(workKeywords)) return "work";
Â  Â  Â  if (check(studyKeywords)) return "study";
Â  Â  Â  if (check(healKeywords)) return "heal";
Â  Â  Â  return "other";
Â  Â  }

Â  Â  function updateTopicUI(topic, fromUser) {
Â  Â  Â  currentTopic = topic;
Â  Â  Â  if (fromUser) {
Â  Â  Â  Â  topicOverride = topic;
Â  Â  Â  }
Â  Â  Â  const label = topicLabels[topic] || topicLabels.other;
Â  Â  Â  topicTextSpan.textContent = `ç›®å‰ä¸»é¡Œï¼š${label}ï¼ˆ${fromUser ? "æ‰‹å‹•é¸æ“‡" : "ç³»çµ±åˆ¤å®š"}ï¼‰`;

Â  Â  Â  document.querySelectorAll(".topic-btn").forEach(btn => {
Â  Â  Â  Â  btn.classList.toggle("topic-active", btn.dataset.topic === topic);
Â  Â  Â  });
Â  Â  }

Â  Â  function autoDetectTopic() {
Â  Â  Â  if (topicOverride) return;
Â  Â  Â  const note = noteTextarea.value;
Â  Â  Â  const detected = detectTopicFromNote(note);
Â  Â  Â  updateTopicUI(detected, false);
Â  Â  }

Â  Â  // ---- ç¶å®šäº‹ä»¶ ----
Â  Â  updateTopicUI("other", false);
Â  Â  noteTextarea.addEventListener("input", () => {
Â  Â  Â  topicOverride = null; 
Â  Â  Â  autoDetectTopic();
Â  Â  });

Â  Â  document.querySelectorAll(".topic-btn").forEach(btn => {
Â  Â  Â  btn.addEventListener("click", () => {
Â  Â  Â  Â  const t = btn.dataset.topic;
Â  Â  Â  Â  updateTopicUI(t, true);
Â  Â  Â  });
Â  Â  });
    
    // å°‡ API å‘¼å«å…¬é–‹çµ¦æŒ‰éˆ•
    window.getHoroscope = getHoroscope; 

    // æ•´åˆ Gemini API å‘¼å«
Â  Â  async function getHoroscope() {
        const sign = signSelect.value;
        const note = noteTextarea.value;
        autoDetectTopic(); // æœ€çµ‚ç¢ºèªä¸»é¡Œ
        const topicLabel = topicLabels[currentTopic] || topicLabels.other;

        if (!sign) {
            resultBox.innerHTML = 'è«‹å…ˆé¸æ“‡ä¸€å€‹æ˜Ÿåº§ï¼';
            return;
        }
        
        if (API_ENDPOINT.includes(' https://uninured-buzzingly-verna.ngrok-free.dev')) {
             resultBox.innerHTML = '<h3>ğŸš¨ é…ç½®éŒ¯èª¤ï¼</h3><p>è«‹å°‡ index.html ä¸­çš„ API_ENDPOINT æ›¿æ›æˆæ‚¨çš„ Ngrok å…¬é–‹ URLã€‚</p>';
             return;
        }

        // æç¤ºä½¿ç”¨è€…ï¼ŒAI å°‡æœƒæ ¹æ“šä»–å€‘è¼¸å…¥çš„ note å’Œåµæ¸¬åˆ°çš„ä¸»é¡Œä¾†ç”Ÿæˆå…§å®¹
        const initialNote = note.trim() ? `ï¼ˆåƒè€ƒä¸»é¡Œï¼š${topicLabel}ï¼‰` : '';
        const loadingText = `æ­£åœ¨å‘å®‡å®™é€£ç·šï¼Œè«‹ç¨å€™... ${initialNote}`;

        resultBox.innerHTML = `<span class="loading-pulse">${loadingText}</span>`;
        horoscopeButton.disabled = true;

        try {
            // ç™¼é€ä¸»é¡Œå’Œå‚™è¨»çµ¦å¾Œç«¯ Flask æœå‹™
            const response = await fetch(API_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ 
                    constellation: sign,
                    note: note,
                    topic: currentTopic
                })
            });

            const data = await response.json();

            if (response.ok) {
                // æˆåŠŸå–å¾—é‹å‹¢
                
                // å¢åŠ ä¸»é¡Œä½œç‚ºé–‹é ­
                const finalOutput = `ã€${sign}ï½œä»Šæ—¥è§£æï½œä¸»é¡Œï¼š${topicLabel}ã€‘\n\n` + data.horoscope;
                resultBox.textContent = finalOutput;
            } else {
                // è™•ç† API æˆ–å¾Œç«¯éŒ¯èª¤
                resultBox.innerHTML = `
                    <h3>ğŸ”´ è§£æå¤±æ•— (HTTP ${response.status})ï¼</h3>
                    <p><strong>éŒ¯èª¤é¡å‹:</strong> ${data.error || 'ä¼ºæœå™¨æœªå›æ‡‰'}</p>
                    <p><strong>è©³æƒ…:</strong> ${data.details || 'è«‹æª¢æŸ¥æ‚¨çš„ Flask å¾Œç«¯ç¨‹å¼ç¢¼å’Œ API Keyã€‚'}</p>
                `;
            }
        } catch (error) {
            // è™•ç†ç¶²è·¯é€£ç·šå¤±æ•—
            console.error('Fetch error:', error);
            resultBox.innerHTML = `
                <h3>ğŸš¨ é€£ç·šä¸­æ–·ï¼</h3>
                <p><strong>åŸå› :</strong> ç„¡æ³•é€£ç·šåˆ°å¾Œç«¯ä¼ºæœå™¨ã€‚</p>
                <p><strong>å»ºè­°:</strong> è«‹ç¢ºèªæ‚¨çš„ Flask æœå‹™ (5000) å’Œ Ngrok æœå‹™éƒ½å·²å•Ÿå‹•ã€‚</p>
            `;
        } finally {
            horoscopeButton.disabled = false;
        }
    }
Â  </script>
</body>
</html>